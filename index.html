<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>çƒè–©å¥‡å°è©±èˆ‡æˆ°é¬¥</title>
  <style>
    body {
      font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
      background-color: #fff8e1;
      color: #5d4037;
      padding: 20px;
      overflow: hidden;
      position: relative; /* ç¡®ä¿åŠ¨ç”»ä¸è¢«é®æŒ¡ */
    }
    h3 {
      color: #ff9800;
    }
    .section {
      margin-bottom: 20px;
      border: 2px solid #ffcc80;
      padding: 15px;
      border-radius: 10px;
      background: #fff3e0;
    }
    button {
      background-color: #ffcc80;
      color: #4e342e;
      border: none;
      padding: 10px;
      margin: 5px;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background-color: #ffb74d;
    }
    input {
      padding: 5px;
      margin-right: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    /* ç«ç„°ç²’å­ç‰¹æ•ˆ */
    .fireEffect {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 30px;
      color: #ff5722;
      text-shadow: 0 0 15px #ffcc80, 0 0 25px #ff5722;
      animation: fireAnim 3s ease-out forwards;
      z-index: 999;
    }

    @keyframes fireAnim {
      0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      30% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0.8;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.5);
        opacity: 0.6;
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0;
      }
    }

    /* é›ªèŠ±æ•ˆæœ */
    .snow {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }
    .snowflake {
      position: absolute;
      top: -10px;
      background: #fff;
      border-radius: 50%;
      width: 5px;
      height: 5px;
      animation: snowfall 10s linear infinite;
    }
    @keyframes snowfall {
      0% {
        transform: translateX(0) translateY(0);
      }
      100% {
        transform: translateX(100px) translateY(100vh);
      }
    }

    /* é›¨æ»´æ•ˆæœ */
    .rain {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }
    .raindrop {
      position: absolute;
      top: -10px;
      background: #00bcd4;
      width: 2px;
      height: 10px;
      animation: rainfall 1s linear infinite;
    }
    @keyframes rainfall {
      0% {
        transform: translateY(0);
      }
      100% {
        transform: translateY(100vh);
      }
    }

    /* é›·ç”µæ•ˆæœ */
    .lightning {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      opacity: 0;
      animation: lightningStrike 3s infinite;
    }
    @keyframes lightningStrike {
      0% {
        opacity: 0;
      }
      50% {
        opacity: 1;
        background-color: rgba(255, 255, 255, 0.7); /* ä½¿é—ªç”µæ•ˆæœæ›´æŸ”å’Œ */
      }
      100% {
        opacity: 0;
      }
    }

    /* æ”»æ“Šã€æŠ€èƒ½å‹•ç•« */
    .attackAnimation, .defendAnimation, .skillAnimation {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 24px;
      font-weight: bold;
      color: #ff9800;
      animation: attackSkillAnim 1.5s ease-out forwards;
      z-index: 999;
    }

    @keyframes attackSkillAnim {
      0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0.8;
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0;
      }
    }

  </style>
</head>
<body>

<div class="section">
  <h3>ğŸ° çƒè–©å¥‡ å°è©±æ¡†</h3>
  <div id="npcDialog">çƒè–©å¥‡å›æ‡‰ä½ ï¼šã€ŒWUlaaaaaaaaã€</div>
  <input type="text" id="visitorInput" placeholder="è·Ÿçƒè–©å¥‡èªªé»ä»€éº¼...">
  <button onclick="respondToVisitor()">ç™¼é€</button>
</div>

<div class="section">
  <h3>âš”ï¸ ä¾†ä¸€æ£</h3>
  <p>çƒè–©å¥‡537è¡€é‡ï¼š<span id="enemyHP">100</span> | ç©å®¶è¡€é‡ï¼š<span id="playerHP">100</span></p>
  <button onclick="battle('attack')">æ”»æ“Š</button>
  <button onclick="battle('defend')">é˜²ç¦¦</button>
  <button onclick="battle('skill')">æŠ€èƒ½</button>
  <p id="battleLog"></p>
</div>

<script>
  let playerHP = 100, enemyHP = 100;

  // æ·»åŠ é›ªèŠ±æ•ˆæœ
  const snowContainer = document.createElement('div');
  snowContainer.classList.add('snow');
  document.body.appendChild(snowContainer);

  function createSnowflakes() {
    for (let i = 0; i < 50; i++) {
      const snowflake = document.createElement('div');
      snowflake.classList.add('snowflake');
      snowflake.style.left = `${Math.random() * 100}vw`;
      snowflake.style.animationDuration = `${Math.random() * 10 + 5}s`;
      snowContainer.appendChild(snowflake);
    }
  }

  // æ·»åŠ é›¨æ»´æ•ˆæœ
  const rainContainer = document.createElement('div');
  rainContainer.classList.add('rain');
  document.body.appendChild(rainContainer);

  function createRaindrops() {
    for (let i = 0; i < 100; i++) {
      const raindrop = document.createElement('div');
      raindrop.classList.add('raindrop');
      raindrop.style.left = `${Math.random() * 100}vw`;
      raindrop.style.animationDuration = `${Math.random() * 1 + 0.5}s`;
      rainContainer.appendChild(raindrop);
    }
  }

  // æ·»åŠ é›·ç”µæ•ˆæœ
  const lightningContainer = document.createElement('div');
  lightningContainer.classList.add('lightning');
  document.body.appendChild(lightningContainer);

  // éšæœºè§¦å‘æ•ˆæœ
  function triggerRandomEffect() {
    // æ¸…é™¤æ—§ç‰¹æ•ˆ
    document.querySelectorAll('.snowflake, .raindrop').forEach((el) => el.remove());
    document.querySelectorAll('.fireEffect').forEach((el) => el.remove());

    const randomEffect = Math.floor(Math.random() * 4);  // æ”¹ä¸º4ï¼Œç¡®ä¿åŒ…æ‹¬æ‰€æœ‰ç‰¹æ•ˆ
    if (randomEffect === 0) {
      createSnowflakes();
    } else if (randomEffect === 1) {
      createRaindrops();
    } else if (randomEffect === 2) {
      createLightningEffect();
    } else {
      createFireEffect();
    }
  }

  // é›·ç”µæ•ˆæœå‡½æ•°
  function createLightningEffect() {
    const lightning = document.createElement('div');
    lightning.classList.add('lightning');
    document.body.appendChild(lightning);
  }

  // ç«ç„°ç‰¹æ•ˆ
  function createFireEffect() {
    const fireEffect = document.createElement("div");
    fireEffect.classList.add("fireEffect");
    fireEffect.innerText = "ç«ç„°çˆ†ç™¼ï¼";
    document.body.appendChild(fireEffect);
    setTimeout(() => fireEffect.remove(), 3000);  // å»¶é•·å‹•ç•«é¡¯ç¤ºæ™‚é–“
  }

  // æ”»æ“Šã€é˜²ç¦¦ã€æŠ€èƒ½å‹•ç•«
  function battle(action) {
    const log = document.getElementById("battleLog");
    let msg = "";

    // æ¸…é™¤å¯èƒ½çš„æ—§åŠ¨ç”»
    document.querySelectorAll('.attackAnimation, .defendAnimation, .skillAnimation').forEach((el) => el.remove());

    if (action === "attack") {
      const attackAnim = document.createElement("div");
      attackAnim.classList.add("attackAnimation");
      attackAnim.innerText = "æ”»æ“Šï¼";
      document.body.appendChild(attackAnim);
      setTimeout(() => attackAnim.remove(), 1500);

      const dmg = Math.floor(Math.random() * 20 + 10);
      enemyHP -= dmg;
      msg = `ä½ é€ æˆäº† ${dmg} é»å‚·å®³ï¼`;

    } else if (action === "defend") {
      const defendAnim = document.createElement("div");
      defendAnim.classList.add("defendAnimation");
      defendAnim.innerText = "é˜²ç¦¦ï¼";
      document.body.appendChild(defendAnim);
      setTimeout(() => defendAnim.remove(), 1500);

      msg = "ä½ æˆåŠŸé˜²ç¦¦äº†æ”»æ“Šï¼";

    } else if (action === "skill") {
      const skillAnim = document.createElement("div");
      skillAnim.classList.add("skillAnimation");
      skillAnim.innerText = "æŠ€èƒ½ï¼";
      document.body.appendChild(skillAnim);
      setTimeout(() => skillAnim.remove(), 1500);

      const skillDmg = Math.floor(Math.random() * 40 + 20);
      enemyHP -= skillDmg;
      msg = `ä½ ä½¿ç”¨æŠ€èƒ½é€ æˆäº† ${skillDmg} é»å‚·å®³ï¼`;
    }

    document.getElementById("enemyHP").textContent = enemyHP;
    log.textContent = msg;

    // éšæœºè§¦å‘èƒŒæ™¯æ•ˆæœ
    triggerRandomEffect();
  }

  // åˆå§‹åŠ è½½æ—¶è§¦å‘ç‰¹æ•ˆ
  createRaindrops();
  setInterval(triggerRandomEffect, 5000);
</script>

</body>
</html>
